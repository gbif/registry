<h4 ng-hide="dataset.key == undefined">Dataset overview</h4>
<h4 ng-show="dataset.key == undefined">Create a new Dataset</h4>

<p class="muted">This information appears on the dataset profile, organization pages, search results, and beyond.  It should be the same as found in the GBIF internal systems, such as the IMS</p>
<p class="pull-right" ng-show="advancedMode != true && dataset.key != undefined">
  <a href="" ng-click="advancedMode = true"><small>Enable advanced editing mode</small></a>
</p>
<hr/>
<br/>
<form id="datasetEdit" novalidate class="form-horizontal">
  <fieldset class="control-group">

    <label class='control-label' for='type'>Type</label>
    <div class='controls'>
      <select ng-model="dataset.type" ng-options="o for o in datasetTypes"></select>
      <p class='muted'><small></small></p>
    </div>

    <label class='control-label' for='subType'>Subtype</label>
    <div class='controls'>
      <select ng-model="dataset.subType" ng-options="o for o in datasetSubTypes"></select>
      <p class='muted'><small></small></p>
    </div>

    <label class='control-label' for='external'>External</label>
    <div class='controls'>
      <label class="checkbox">
        <input type="checkbox" id="external" value="{{dataset.external}}" ng-checked="dataset.external" ng-model="dataset.external">
        <small class='muted'>Indicates that the dataset is found through integration with metadata networks, and not registered directly with GBIF</small>
      </label>
    </div>

	<span ng-show="advancedMode || dataset.key == undefined">
    <label class='control-label' for='lockedForAutoUpdate'>Lock auto updates</label>
    <div class='controls'>
      <label class="checkbox">
        <input type="checkbox" id="lockedForAutoUpdate" value="{{dataset.lockedForAutoUpdate}}" ng-checked="dataset.lockedForAutoUpdate" ng-model="dataset.lockedForAutoUpdate"/>
        <small class="muted">Controls permissions for crawlers updating metadata, contacts etc</small>
      </label>
      <p><span class="label label-important">Important</span> <span class="text-error">Use with caution - disables automated updates<span></p>

    </div>
    </span>

    <label class='control-label' for='title'>Title</label>
    <div class='controls'>
      <input id='title' maxlength='255' type='text' ng-model='dataset.title'>
      <p class='muted'><small></small></p>
    </div>

    <label class='control-label' for='alias'>Alias</label>
    <div class='controls'>
      <input id='alias' maxlength='255' type='text' ng-model='dataset.alias'>
      <p class='muted'><small>TODO: explain or remove this</small></p>
    </div>

    <label class='control-label' for='abbreviation'>Abbreviation</label>
    <div class='controls'>
      <input id='abbreviation' maxlength='255' type='text' ng-model='dataset.abbreviation'>
      <p class='muted'><small>TODO: explain or remove this</small></p>
    </div>

    <label class='control-label' for='description'>Description</label>
    <div class='controls'>
      <input id='description' maxlength='255' type='text' ng-model='dataset.description'>
      <p class='muted'><small></small></p>
    </div>

    <span ng-show="advancedMode || dataset.key == undefined">
    <label class='control-label' for='publishingOrganizationKey'>Publishing Organization</label>
    <div class='controls'>
      <input id='publishingOrganizationKey' maxlength='255' type='text' ng-model='dataset.publishingOrganizationKey'>
      <p><span class="label label-important">Important</span> <span class="text-error">Changing this will update all occurrence records<span></p>
      <p class='muted'><small>It is expected that this may be changed occasionally, but be vigilant in changes as this has potential to spawn significant processing for occurrence records, metrics and maps</small></p>
    </div>
    </span>

    <span ng-show="advancedMode || dataset.key == undefined">
    <label class='control-label' for='installationKey'>Installation</label>
    <div class='controls'>
      <input id='installationKey' maxlength='255' type='text' ng-model='dataset.installationKey'>
      <p><span class="label label-important">Important</span> <span class="text-error">Changing this will update all occurrence records<span></p>
      <p class='muted'><small>It is expected that this may be changed occasionally, but be vigilant in changes as this has potential to spawn significant processing for occurrence records, metrics.  Please verify the services are as expected on change</small></p>
    </div>
    </span>

    <span ng-show="advancedMode || dataset.key == undefined">
    <label class='control-label' for='parentDatasetKey'>Parent dataset</label>
    <div class='controls'>
      <input id='parentDatasetKey' maxlength='255' type='text' ng-model='dataset.parentDatasetKey'>
      <p class='muted'><small>For use in declaring dataset relationships, such as the constituent parts of the Catalogue of Life</small></p>
    </div>
    </span>

    <span ng-show="advancedMode || dataset.key == undefined">
    <label class='control-label' for='duplicateOfDatasetKey'>Duplicate Dataset</label>
    <div class='controls'>
      <input id='duplicateOfDatasetKey' maxlength='255' type='text' ng-model='dataset.duplicateOfDatasetKey'>
      <p><span class="label label-important">Important</span> <span class="text-error">Changing this will DELETE all occurrence records<span></p>
      <p class='muted'><small>When a dataset is found to be a duplicate of another, then it should be updated.  This will effectively trigger a de-index which is the same as a deletion.  It may be that you ALSO need to set the parent dataset if this has been aggregated.</small></p>
    </div>
    </span>

    <label class='control-label' for='citation'>Citation</label>
    <div class='controls'>
      <input id='citation' maxlength='255' type='text' ng-model='dataset.citation.text'>
      <p class='muted'><small></small></p>
    </div>

    <label class='control-label' for='citationIdentifier'>Citation identifier</label>
    <div class='controls'>
      <input id='citationIdentifier' maxlength='255' type='text' ng-model='dataset.citation.identifier'>
      <p class='muted'><small></small></p>
    </div>

    <label class='control-label' for='rights'>Rights</label>
    <div class='controls'>
      <input id='rights' maxlength='255' type='text' ng-model='dataset.rights'>
      <p class='muted'><small></small></p>
    </div>

    <label class='control-label' for='homepage'>Homepage</label>
    <div class='controls'>
      <input id='homepage' maxlength='255' type='text' ng-model='dataset.homepage'>
      <p class='muted'><small></small></p>
    </div>

    <label class='control-label' for='logoUrl'>Logo</label>
    <div class='controls'>
      <input id='logoUrl' maxlength='255' type='text' ng-model='dataset.logoUrl'>
      <p class='muted'><small></small></p>
    </div>

    <label class='control-label' for='language'>Language</label>
    <div class='controls'>
      <select ng-model="dataset.language" ng-options="o for o in languages"></select>
      <p class='muted'><small>The language used for the likes of description, citation etc</small></p>
    </div>


    <div class="form-actions">
      <button class="btn primary-btn" ng-click="cancelEdit()">Cancel</button>
      <button class="btn primary-btn" ng-click="save(dataset)" type="submit">Save changes</button>
    </div>
    <div class="form-actions" ng-show="advancedMode">
      <small><a href="" data-target="#deleteConfirm" data-toggle="modal">Delete this dataset</a></small>
      <p><small class="muted">A deletion may be reverted at a later date</small></p>
    </div>
    <div id="deleteConfirm" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="title" aria-hidden="true">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="title">Delete?</h3>
      </div>
      <div class="modal-body">
        <p><span class="label label-important">Important</span> <span class="text-error">While a deletion may be undone, it will likely trigger significant processing</span></p>
      </div>
      <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
        <button class="btn btn-primary btn-danger" data-dismiss="modal" ng-click="delete(dataset)">Yes, delete it!</button>
      </div>
    </div>
  </fieldset>
</form>
